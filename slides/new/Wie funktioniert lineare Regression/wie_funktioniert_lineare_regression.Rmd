---
output:
  beamer_presentation:
    theme: "Rochester"
    colortheme: "dove"
    slide_level: 1
    latex_engine: lualatex
classoption: 
- t 
#- "handout"
- "aspectratio=169"
header-includes:
- \usepackage[ngerman]{babel}
- \usepackage{mdframed}
- \newmdtheoremenv{ndef}{Definition}
- \newmdtheoremenv{nsatz}{Satz}
- \def\begincols{\begin{columns}}
- \def\begincol{\begin{column}}
- \def\endcol{\end{column}}
- \def\endcols{\end{columns}}
- \usepackage{emoji}
---

```{r, include=FALSE}
knitr::opts_chunk$set(
  comment = "#>", 
  echo = FALSE,
  fig.width = 5,
  fig.height = 4
)
```

# Ausgangssituation

::: columns

:::: column

Wir haben Daten erhoben:

```{r}
x <- c(-0.5, -1.5, 0.5, 1.5, 2.5)
y <- c(-2, -10, 3.5, 4, 12)
knitr::kable(t(cbind(x,y)), "simple")
```

\pause
Fragen: 

\begin{itemize}
  \item Wie hängen \texttt{x} und \texttt{y} zusammen?
  \pause
  \begin{itemize}
    \item[] Korrelation: \texttt{cor(x,y)} = `r round(cor(x,y),2)`
    \item[] Positiver Zusammenhang! \emoji{face-with-monocle}
  \end{itemize}
  \pause
  \item Wie können wir einen bestimmten Wert von \texttt{y} vorhersagen?
  \pause
  \begin{itemize}
    \item[] Wir brauchen ein Modell!
  \end{itemize}
\end{itemize}


::::

:::: column
\pause

```{r, out.height = "70%"}
library(ggplot2)
beta1_hat <- cov(y,x) / var(x)
beta0_hat <- mean(y) - beta1_hat * mean(x)
ggplot(data = data.frame(x, y), aes(x = x, y = y)) +
  geom_point() +
  geom_abline(slope = beta1_hat, intercept = beta0_hat)
```

\centerline{Ein lineares Modell scheint passend...}
::::

:::

# Lineares Modell (**S**imple **L**inear **R**egression Model)

$$y_i = \beta_0 + \beta_1 x_i + u_i, \quad i = 1,\dots,n$$ \pause
\vspace{-0.5cm}
\begin{itemize}
  \item $i$ ist der Index für eine Beobachtung
  \item $n$ ist die Anzahl Beobachtungen
  \item $y_i$ ist die abhängige (zu erklärende) Variable für die Beobachtung $i$
  \item $x_i$ ist der Regressor (die erklärende Variable) für die Beobachtung $i$
  \item $u_i$ ist der Fehlerterm (der Messfehler) für die Beobachtung $i$
  \item $\beta_0$ und $\beta_1$ sind unbekannte Parameter, die geschätzt werden
  \begin{itemize}
      \item $\beta_0$ ist der Achsenabschnitt (auch Intercept genannt) 
      \item $\beta_1$ ist der Steigungsparameter
  \end{itemize}
\end{itemize}

# 5 Modellannahmen

\vspace{-0.5cm}
\small
\begin{center}
\renewcommand{\arraystretch}{1.5}
\begin{tabular}{lp{2cm}p{4cm}p{5cm}}
       & Stichwort                         & Annahme & wäre z.B.\ verletzt, wenn... \\ \hline
 SLR.1 & \textbf{Modell}                   & $y = \beta_0 + \beta_1 x + u$ mit den Parametern $\beta_0,\ \beta_1 \in \mathbb{R}$ & der Zusammenhang ist exponentiell ($y = \beta_0 e^{\beta_1 x} + u$)\\
 SLR.2 & \textbf{Stichprobe}               & $\{(y_i , x_i ), i = 1, \dots, n\}$ zufällig gemäß SLR.1 generiert & aus der Grundgesamtheit der Wahlberechtigten wurden nur Studierende befragt\\
 SLR.3 & \textbf{Information im Regressor} & $\text{Var}(x) > 0$ & Experiment immer mit den exakt gleichen Parametern durchgeführt \\
 SLR.4 & \textbf{Bedingte Erwartung}       & $\mathbb{E}(u\mid x) = 0$ & es gibt einen systematischen Messfehler \\
 SLR.5 & \textbf{Homoskedastizität}        & $\text{Var}(u\mid x)=\sigma^2$ & die Körpergröße von Kleinkindern hat eine geringere Varianz als die von Erwachsenen\\
\end{tabular}
\end{center}
\normalsize

# Schätzwerte bestimmen

"Kleinste Quadrate" Methode:
\begin{align*}
  {\arg \min}_{\beta_0, \beta_1} \sum_{i = 1}^n (\beta_0 + \beta_1 x_i - y_i)^2
\end{align*}
\pause
Schätzer:
\begin{align*}
  \hat\beta_0 &= \bar{Y} - \hat\beta_1 \bar{X} \\
  \hat\beta_1 &= \frac{\text{Cov}(Y,X)}{\text{Var}(X)}
\end{align*}

# Mehrere Regressoren (**M**ultiple **L**inear **R**egression Model)

Wir sind nicht auf nur einen Regressor beschränkt:

$$y_i = \beta_0 + \beta_1 x_{i,1} + \ldots + \beta_K x_{i,K} + u_i, \quad i = 1,\dots,n$$
\pause Wir werden uns anschauen:

\small
- Wie verändern sich die Annahmen?
- Wie werden hier die Parameter geschätzt? Und was bedeutet \textit{teris paribus}? 
- Was ist die Normalgleichung? Und was bedeutet Multikollinearität?
- Wie führt man eine multiple Regression in \texttt{R} durch? Wie interpretiert man den \texttt{R} Output?
- Und ganz wichtig: Was besagt das Gauss-Markov-Theorem?
\normalsize

\vfill

\hfill Mehr dazu nächste Woche! \emoji{thumbs-up}
